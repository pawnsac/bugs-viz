<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8"/>
    <script src="d3.js"></script>
    <script src="FileData.js"></script>
    <script src="FileDataNew.js"></script>
    <style>
      body {
        font-family: 'Roboto', sans-serif;
        margin: 0;
        padding: 0;
        height: 100vh; /* Ensures the body takes up the full height */
        display: flex;
        flex-direction: column;
      }

      header {
        flex: 0 0 auto; /* Prevents header from taking too much space */
        text-align: center;
        padding: 10px;
        background-color: #b393d3;
      }

      header h1 {
        font-size: 50px;
        font-weight: 600;
        font-family: 'Roboto', sans-serif;
        color: white;
        text-transform: uppercase;
        text-shadow: 1px 1px 0px #957dad,
                    1px 2px 0px #957dad,
                    1px 3px 0px #957dad,
                    1px 4px 0px #957dad,
                    1px 5px 0px #957dad,
                    1px 6px 0px #957dad,
                    1px 10px 5px rgba(16, 16, 16, 0.5),
                    1px 15px 10px rgba(16, 16, 16, 0.4),
                    1px 20px 30px rgba(16, 16, 16, 0.3),
                    1px 25px 50px rgba(16, 16, 16, 0.2);
      }

      /* The visualization container takes up the remaining space */
      .viz-container {
        flex: 1; /* Allows it to expand and take available space */
        display: flex;
        flex-direction: column;
        position: relative;
      }

      svg {
        width: 100%;
        height: 100%; /* Allow svg to take full height */
        display: block;
      }

      .controls {
        position: absolute;
        right: 1em;
        top: 1em;
        background: rgba(255, 255, 255, 0.9);
        padding: 10px;
        border-radius: 10px;
      }

      /* Keeping the style for the "Overview" section as requested */
      .overview {
        background-color: #e6e6fa; /* Light lavender background */
        border-radius: 10px;
        padding: 20px;
        margin: 20px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      }

      .overview ul {
        list-style-type: disc;
        margin: 10px 0;
        padding-left: 20px;
      }

      .overview ul li {
        margin-bottom: 10px;
      }

      .overview strong {
        color: #b393d3; /* Matching accent color */
      }

      .overview a {
        color: #b393d3;
        text-decoration: underline;
      }

      .overview a:hover {
        color: #957dad;
      }

    </style>
  </head>
  <body>
    <header>
      <h1> Tree Map: V8 Bugs </h1>
    </header>

    <div class="viz-container">
      <svg id="svg"></svg>
      <div class="controls">
        <label for="sizeParam">Size Parameter</label>
        <select class="selectSizeBox" name="sizeParam" id="sizeParam">
          <option value="commits">Commits</option>
          <option value="additions"> Additions </option>
          <option value="subtracts"> Deletions </option>
        </select>

        <label for="colorParam">Color Parameter</label>
        <select class="selectColorBox" name="colorParam" id="colorParam">
          <option value="depth">Depth</option>
          <option value="difference">Difference</option>
          <option value="check"> Check Type </option>
          <option value="crash"> Crash Type </option>
          <option value="bounty"> Bounty Value </option>
        </select>
      </div>
    </div>

    <div class="overview">
      <h2> Overview: </h2>
      <p>
        This interactive tree map visualizes bug fixes in <a href="https://v8.dev/">V8</a>, the JavaScript engine that powers Google Chrome. The map displays the impact of bug fixes across different files and folders, letting you explore the data by adjusting size and color parameters in the top-right menu. 
      </p>
      <p> 
        <strong>Size Parameter</strong> controls the size of each rectangle, reflecting different metrics:
        <ul>
          <li><strong>Commits:</strong> The number of commits that affected a file (a single bug might span multiple files).</li>
          <li><strong>Additions:</strong> The average number of lines added per commit.</li>
          <li><strong>Deletions:</strong> The average number of lines removed per commit. (Modifying a line counts as both a deletion and an addition).</li>
        </ul>
      </p>
      <p> 
        <strong>Color Parameter</strong> adjusts the color of each rectangle, based on specific characteristics of the file or bug:
        <ul>
          <li><strong>Depth:</strong> How deep the file is nested in the directory. Darker shades indicate more nested files.</li>
          <li><strong>Difference:</strong> The net change in lines (lines added minus lines deleted). Blue represents files where more lines were deleted, white indicates a balance, and red shows where more lines were added.</li>
          <li><strong>Check Type:</strong> Proportion of bugs related to 'check' errors (e.g., invalid or skipped checks). Darker orange indicates a higher ratio of check-related bugs.</li>
          <li><strong>Crash Type:</strong> Proportion of bugs that led to crashes (e.g., system errors or aborts). Darker red shows more crash-related bugs.</li>
          <li><strong>Bounty Value:</strong> The total bounty reward for fixing bugs in a file. Darker green means higher rewards. <a href="https://bughunters.google.com/about/rules/5745167867576320/chrome-vulnerability-reward-program-rules">Learn more here.</a></li>
        </ul>
      </p>
    </div>

    <script src="TreeMap.js"></script> <!-- Ensure this is included for your tree map to work -->
  </body>
</html>
